import requests
import pandas as pd # ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏™‡∏±‡πâ‡∏ô‡πÜ ‡∏ß‡πà‡∏≤ pd

# 1. ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏°)
url = "https://api.coingecko.com/api/v3/coins/bitcoin/market_chart?vs_currency=thb&days=30" # ‡∏Ç‡∏≠ 30 ‡∏ß‡∏±‡∏ô‡πÄ‡∏•‡∏¢
response = requests.get(url)
data = response.json()
raw_data = data['prices'] # [[‡πÄ‡∏ß‡∏•‡∏≤, ‡∏£‡∏≤‡∏Ñ‡∏≤], [‡πÄ‡∏ß‡∏•‡∏≤, ‡∏£‡∏≤‡∏Ñ‡∏≤], ...]

# 2. ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á (DataFrame)
# ‡πÅ‡∏Ñ‡πà‡∏ö‡∏≠‡∏Å‡∏°‡∏±‡∏ô‡∏ß‡πà‡∏≤ data ‡∏Ñ‡∏∑‡∏≠‡∏≠‡∏∞‡πÑ‡∏£ ‡πÅ‡∏•‡∏∞‡∏ï‡∏±‡πâ‡∏á‡∏ä‡∏∑‡πà‡∏≠ columns ‡πÉ‡∏´‡πâ‡∏°‡∏±‡∏ô
df = pd.DataFrame(raw_data, columns=['Timestamp', 'Price'])

# 3. ‡πÅ‡∏õ‡∏•‡∏á‡πÄ‡∏ß‡∏•‡∏≤ (Magic Command! ‚ú®)
# ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡πÄ‡∏î‡∏µ‡∏¢‡∏ß ‡πÅ‡∏õ‡∏•‡∏á‡πÄ‡∏•‡∏Ç Unix ‡πÄ‡∏õ‡πá‡∏ô‡∏ß‡∏±‡∏ô‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡∏°‡∏ô‡∏∏‡∏©‡∏¢‡πå‡∏≠‡πà‡∏≤‡∏ô‡∏≠‡∏≠‡∏Å‡∏ó‡∏±‡πâ‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á
df['Date'] = pd.to_datetime(df['Timestamp'], unit='ms')

# 4. ‡∏î‡∏π‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡∏≤‡∏ï‡∏≤‡∏£‡∏≤‡∏á (5 ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡πÅ‡∏£‡∏Å)
print("--- ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• 5 ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡πÅ‡∏£‡∏Å ---")
print(df.head()) 

# 5. ‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏£‡∏∏‡∏õ (Info)
print("\n--- ‡∏™‡∏£‡∏∏‡∏õ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ---")
print(df.info())

# ... (‡∏ï‡πà‡∏≠‡∏à‡∏≤‡∏Å‡∏Ç‡πâ‡∏≤‡∏á‡∏ö‡∏ô) ...

print("\n" + "="*30)
print("üìä ‡∏™‡∏£‡∏∏‡∏õ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥ Bitcoin 30 ‡∏ß‡∏±‡∏ô‡∏¢‡πâ‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏á")
print("="*30)

# 1. ‡∏´‡∏≤‡∏Ñ‡πà‡∏≤‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î (Max)
max_price = df['Price'].max()
print(f"‡∏£‡∏≤‡∏Ñ‡∏≤‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î: {max_price:,.2f} ‡∏ö‡∏≤‡∏ó")

# 2. ‡∏´‡∏≤‡∏Ñ‡πà‡∏≤‡∏ï‡πà‡∏≥‡∏™‡∏∏‡∏î (Min)
min_price = df['Price'].min()
print(f"‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ï‡πà‡∏≥‡∏™‡∏∏‡∏î: {min_price:,.2f} ‡∏ö‡∏≤‡∏ó")

# 3. ‡∏´‡∏≤‡∏Ñ‡πà‡∏≤‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢ (Mean)
avg_price = df['Price'].mean()
print(f"‡∏£‡∏≤‡∏Ñ‡∏≤‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢: {avg_price:,.2f} ‡∏ö‡∏≤‡∏ó")

print("-" * 30)

# 4. Advance: ‡∏´‡∏≤‡∏ß‡πà‡∏≤ "‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏ó‡πà‡∏≤‡πÑ‡∏´‡∏£‡πà" ‡∏ó‡∏µ‡πà‡∏£‡∏≤‡∏Ñ‡∏≤‡πÅ‡∏û‡∏á‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î?
# idxmax() ‡∏à‡∏∞‡∏Ñ‡∏∑‡∏ô‡∏Ñ‡πà‡∏≤ '‡πÄ‡∏•‡∏Ç‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î' ‡∏ó‡∏µ‡πà‡∏£‡∏≤‡∏Ñ‡∏≤‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î
max_index = df['Price'].idxmax() 
hottest_day = df.loc[max_index, 'Date'] # ‡πÑ‡∏õ‡∏î‡∏∂‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà ‡∏à‡∏≤‡∏Å‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏ô‡∏±‡πâ‡∏ô

print(f"üìÖ ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏û‡∏á‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡∏Ñ‡∏∑‡∏≠: {hottest_day}")

print(f"‡∏ú‡∏±‡∏ô‡∏ú‡∏ß‡∏ô‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ö {max_price-min_price:.2f} ‡∏ö‡∏≤‡∏ó")

import matplotlib.pyplot as plt # ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏°‡∏≤‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏ä‡πâ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á show()

# ... (‡πÇ‡∏Ñ‡πâ‡∏î‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì) ...

print("\n‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ß‡∏≤‡∏î‡∏Å‡∏£‡∏≤‡∏ü‡∏î‡πâ‡∏ß‡∏¢ Pandas...")

# 1. ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÉ‡∏´‡πâ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå 'Date' ‡πÄ‡∏õ‡πá‡∏ô‡πÅ‡∏Å‡∏ô X (Index)
# inplace=True ‡πÅ‡∏õ‡∏•‡∏ß‡πà‡∏≤ "‡πÅ‡∏Å‡πâ‡∏ó‡∏µ‡πà‡∏ï‡∏±‡∏ß‡∏ï‡∏≤‡∏£‡∏≤‡∏á df ‡πÄ‡∏•‡∏¢ ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡πÉ‡∏´‡∏°‡πà"
df.set_index('Date', inplace=True)

# 2. ‡∏™‡∏±‡πà‡∏á‡∏ß‡∏≤‡∏î‡∏Å‡∏£‡∏≤‡∏ü‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå Price
# ‡∏™‡∏±‡πà‡∏á‡πÅ‡∏Ñ‡πà‡∏ô‡∏µ‡πâ‡πÄ‡∏•‡∏¢! Pandas ‡∏à‡∏∞‡∏£‡∏π‡πâ‡πÄ‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏≠‡∏≤ Date ‡∏°‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡πÅ‡∏Å‡∏ô X
df['Price'].plot(color='green', figsize=(10, 5), title='Bitcoin Price (30 Days)')

# 3. ‡πÇ‡∏ä‡∏ß‡πå
plt.ylabel("Price (THB)")
plt.grid()
plt.show()